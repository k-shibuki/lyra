---
description: "Running lint, format, or type checks: fix approaches and prohibited workarounds"
alwaysApply: false
---
# Quality Check Conventions

This rule defines the **policy** applied when executing `/quality-check`.
Procedures (which commands to run and how) are documented in `@.cursor/commands/quality-check.md`.

## Basic Principle

**Always resolve warnings and errors from the root cause. Don't "silence" them with workarounds.**

## Prohibited Practices (Workarounds)

The following are prohibited in principle (exception only with stated justification):

- Suppressing type errors with `# type: ignore`
- Disabling lint with `# noqa` (except with valid justification)
- Type concealment by "escaping to Any" like `cast(Any, ...)`
- Avoiding type errors with overly broad types (`Any`, `object`)

## Correct Fix Approaches

- Add appropriate type annotations
- Narrow types with type guards (`isinstance`, `assert`)
- Limit `cast()` to conversions to concrete types only (e.g., `cast(str, ...)`, `cast(dict[str, Any], ...)`)
- Supplement missing type stubs with `types-*` packages etc. (where possible)

## Check Targets (Minimum Required Execution)

1. Ruff lint **errors and warnings**
2. Ruff format **diffs**
3. mypy **errors and warnings**
4. check-jsonschema **errors and warnings** (JSON schema file validation)
5. Inappropriate `Any` introduction (new additions, propagation)
6. Clear security issues (authentication/authorization, input validation, data retention)

## About Exceptions (Intentional Lint)

When intentionally violating lint rules, always **state the reason in docstring or comment**.

Example (E402):

```python
# E402: Intentionally import after pytestmark for test configuration
pytestmark = pytest.mark.unit
from src.module import Something
```

## Definition of Done

Fix existing errors unrelated to changes as well; all of the following must be satisfied:

- `ruff check` has **zero errors/warnings**
- `ruff format --check` has **zero diffs**
- `mypy` shows **Success: no issues found**
- `check-jsonschema` has **zero errors/warnings** (JSON schema files are valid JSON Schema Draft 7 format)
- Exceptions (intentional lint) have **documented reasons**
- No new `# type: ignore` / unjustified `# noqa` added
- Not hiding problems with `Any`
