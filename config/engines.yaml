# Lyra - Search Engine Configuration
# allowlist/denylist and per-engine settings

# === Engine Selection Policy ===
# Default engines to enable for general searches
# IMPORTANT: Only include engines with implemented parsers
# Implemented: duckduckgo, mojeek, google, brave, ecosia, startpage, bing
# NOT implemented: wikipedia, wikidata, marginalia, arxiv, pubmed, qwant
default_engines:
  - mojeek       # Block-resistant, independent index
  - duckduckgo   # General purpose, good availability
  - brave        # Independent index, good for technical queries

# Last-mile engines (strict limits, used when other engines fail)
lastmile_engines:
  - brave
  - google
  - bing

# === Engine Definitions ===
engines:
  # === High Priority (Block-resistant) ===
  wikipedia:
    priority: 1
    weight: 1.0
    categories: [general, knowledge]
    qps: 0.5
    block_resistant: true
    
  wikidata:
    priority: 1
    weight: 0.9
    categories: [knowledge, structured]
    qps: 0.5
    block_resistant: true
    
  mojeek:
    priority: 2
    weight: 0.85
    categories: [general]
    qps: 0.25
    block_resistant: true
    
  marginalia:
    priority: 2
    weight: 0.8
    categories: [general, technical]
    qps: 0.25
    block_resistant: true
    
  duckduckgo:
    priority: 3
    weight: 0.7
    categories: [general]
    qps: 0.2
    block_resistant: false
  
  # === Additional Engines ===
  ecosia:
    priority: 4
    weight: 0.5
    categories: [general]
    qps: 0.15
    block_resistant: false
    description: "Bing-based, relatively lenient, privacy-focused"
    
  startpage:
    priority: 5
    weight: 0.3
    categories: [general]
    qps: 0.1
    block_resistant: false
    description: "Google-based, privacy-focused"
    
  # === Academic/Specialized ===
  arxiv:
    priority: 1
    weight: 1.0
    categories: [academic, technical]
    qps: 0.25
    block_resistant: true
    
  pubmed:
    priority: 1
    weight: 1.0
    categories: [academic, medical]
    qps: 0.25
    block_resistant: true
    
  # === Last-mile (Strict Limits) ===
  # These engines have low priority and weight, used only when others fail
  brave:
    priority: 5
    weight: 0.3
    categories: [general]
    qps: 0.1
    block_resistant: false
    daily_limit: 50
    
  google:
    priority: 10  # Very low priority (last-mile only)
    weight: 0.1
    categories: [general]
    qps: 0.05
    block_resistant: false
    daily_limit: 10
    
  bing:
    priority: 10  # Very low priority (last-mile only)
    weight: 0.1
    categories: [general]
    qps: 0.05
    block_resistant: false
    daily_limit: 10

# === Query Operator Mapping ===
# Maps standard operators to engine-specific syntax
operator_mapping:
  site:
    default: "site:{domain}"
    google: "site:{domain}"
    bing: "site:{domain}"
    duckduckgo: "site:{domain}"
    qwant: "site:{domain}"
    ecosia: "site:{domain}"
    startpage: "site:{domain}"
    
  filetype:
    default: "filetype:{type}"
    google: "filetype:{type}"
    bing: "filetype:{type}"
    duckduckgo: "filetype:{type}"
    ecosia: "filetype:{type}"
    startpage: "filetype:{type}"
    
  intitle:
    default: "intitle:{text}"
    google: "intitle:{text}"
    bing: "intitle:{text}"
    
  exact:
    default: '"{text}"'
    google: '"{text}"'
    bing: '"{text}"'
    duckduckgo: '"{text}"'
    ecosia: '"{text}"'
    startpage: '"{text}"'
    
  exclude:
    default: "-{term}"
    google: "-{term}"
    bing: "-{term}"
    ecosia: "-{term}"
    startpage: "-{term}"
    
  date_after:
    default: null  # Not all engines support
    google: "after:{date}"
    
# === Category-Engine Mapping ===
# NOTE: Only reference engines with implemented parsers
# Unimplemented engines are commented out for future use
category_engines:
  general:
    # - wikipedia    # Parser not implemented
    - mojeek
    # - marginalia   # Parser not implemented
    # - qwant        # Removed: region restriction
    - duckduckgo
    - ecosia
    - startpage
    
  academic:
    # All academic engines have no parser implemented yet
    # - arxiv        # Parser not implemented
    # - pubmed       # Parser not implemented
    # - wikipedia    # Parser not implemented
    - mojeek         # Fallback to general search
    - duckduckgo
    
  news:
    # - qwant        # Removed: region restriction
    - duckduckgo
    
  government:
    # - wikipedia    # Parser not implemented
    - mojeek
    - duckduckgo
    
  technical:
    # - marginalia   # Parser not implemented
    # - arxiv        # Parser not implemented
    # - wikipedia    # Parser not implemented
    - mojeek         # Fallback to general search
    - duckduckgo

# === Direct Source Priorities ===
# For academic/public sources, prefer direct access over search
direct_sources:
  academic:
    - domain: "arxiv.org"
      priority: 1
      search_url: "https://arxiv.org/search/?searchtype=all&query={query}"
      
    - domain: "pubmed.ncbi.nlm.nih.gov"
      priority: 1
      search_url: "https://pubmed.ncbi.nlm.nih.gov/?term={query}"
      
    - domain: "www.jstage.jst.go.jp"
      priority: 1
      search_url: "https://www.jstage.jst.go.jp/result/global/-char/ja?item1=4&word1={query}"
      
    - domain: "cir.nii.ac.jp"
      priority: 1
      search_url: "https://cir.nii.ac.jp/all?q={query}"
      
  government:
    - domain: "e-gov.go.jp"
      priority: 1
      
    - domain: "www.gov.uk"
      priority: 1
      
    - domain: "who.int"
      priority: 1
