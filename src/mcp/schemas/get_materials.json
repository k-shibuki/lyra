{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "lyra:mcp:get_materials",
  "title": "get_materials Response",
  "description": "Response schema for get_materials tool (ADR-0003: report materials)",
  "type": "object",
  "properties": {
    "ok": {
      "type": "boolean"
    },
    "task_id": {
      "type": "string"
    },
    "query": {
      "type": "string"
    },
    "claims": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "text": {
            "type": "string"
          },
          "bayesian_claim_confidence": {
            "type": "number",
            "description": "Bayesian posterior confidence (0.0-1.0). Primary metric for truth assessment after evidence aggregation."
          },
          "llm_claim_confidence": {
            "type": "number",
            "description": "LLM's self-reported extraction quality (0.0-1.0). NOT truth confidence. Low values (<0.5) indicate extraction may be unreliable."
          },
          "uncertainty": {
            "type": "number",
            "description": "Bayesian uncertainty (stddev of Beta distribution, 0.0-0.5). High value (>0.2) indicates insufficient evidence - consider queue_searches for more sources."
          },
          "controversy": {
            "type": "number",
            "description": "Degree of conflict between supports/refutes evidence (0.0-0.5). High value (>0.3) indicates contested claim - investigate both sides before concluding."
          },
          "evidence_count": {
            "type": "integer"
          },
          "has_refutation": {
            "type": "boolean"
          },
          "sources": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "url": {
                  "type": "string"
                },
                "title": {
                  "type": "string"
                },
                "domain": {
                  "type": "string"
                },
                "domain_category": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "is_primary": {
                  "type": "boolean"
                }
              },
              "additionalProperties": false
            }
          },
          "evidence": {
            "type": "array",
            "description": "Evidence items with NLI labels and temporal metadata. Use edge_id with feedback(edge_correct) to fix NLI errors.",
            "items": {
              "type": "object",
              "properties": {
                "edge_id": {
                  "type": [
                    "string",
                    "null"
                  ],
                  "description": "Edge ID for feedback(edge_correct). Use this to correct NLI classification errors."
                },
                "relation": {
                  "type": "string",
                  "enum": [
                    "supports",
                    "refutes",
                    "neutral"
                  ]
                },
                "source_id": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "source_type": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "year": {
                  "type": [
                    "integer",
                    "string",
                    "null"
                  ]
                },
                "nli_edge_confidence": {
                  "type": [
                    "number",
                    "null"
                  ],
                  "description": "NLI model's calibrated confidence for this evidence relation (0.0-1.0)."
                },
                "source_domain_category": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "doi": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "venue": {
                  "type": [
                    "string",
                    "null"
                  ]
                }
              },
              "additionalProperties": false
            }
          },
          "evidence_years": {
            "type": "object",
            "description": "Summary of evidence years (oldest/newest).",
            "properties": {
              "oldest": {
                "type": [
                  "integer",
                  "null"
                ]
              },
              "newest": {
                "type": [
                  "integer",
                  "null"
                ]
              }
            },
            "additionalProperties": false
          },
          "claim_adoption_status": {
            "type": "string",
            "enum": [
              "adopted",
              "pending",
              "not_adopted"
            ],
            "description": "Adoption status for high-reasoning AI to filter claims"
          },
          "claim_rejection_reason": {
            "type": [
              "string",
              "null"
            ],
            "description": "Reason for rejection if claim_adoption_status is not_adopted"
          }
        },
        "additionalProperties": false
      },
      "description": "LLM-extracted claims with Bayesian confidence metrics. Use bayesian_claim_confidence for truth assessment, llm_claim_confidence for extraction quality."
    },
    "fragments": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "text": {
            "type": "string"
          },
          "source_url": {
            "type": "string"
          },
          "context": {
            "type": "string"
          },
          "is_primary": {
            "type": "boolean"
          }
        },
        "additionalProperties": false
      },
      "description": "Extracted text fragments (L4 sanitized)"
    },
    "summary": {
      "type": "object",
      "properties": {
        "total_claims": {
          "type": "integer"
        },
        "verified_claims": {
          "type": "integer"
        },
        "refuted_claims": {
          "type": "integer"
        },
        "primary_source_ratio": {
          "type": "number"
        }
      },
      "additionalProperties": false
    },
    "evidence_graph": {
      "type": [
        "object",
        "null"
      ],
      "description": "Evidence graph with claim-evidence relationships and citation network",
      "properties": {
        "nodes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "description": "Node ID in format {node_type}:{obj_id}"
              },
              "node_type": {
                "type": "string",
                "enum": [
                  "claim",
                  "fragment",
                  "page"
                ]
              },
              "obj_id": {
                "type": "string",
                "description": "Object ID (claim_id, fragment_id, or page_id)"
              }
            }
          }
        },
        "edges": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "source": {
                "type": "string"
              },
              "target": {
                "type": "string"
              },
              "relation": {
                "type": "string",
                "enum": [
                  "supports",
                  "refutes",
                  "neutral",
                  "cites",
                  "evidence_source"
                ],
                "description": "Edge relation type. cites = page->page citation, evidence_source = claim->page (Phase 2)"
              },
              "edge_id": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "nli_label": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "nli_edge_confidence": {
                "type": [
                  "number",
                  "null"
                ]
              },
              "citation_source": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "citation_context": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "source_domain_category": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "target_domain_category": {
                "type": [
                  "string",
                  "null"
                ]
              }
            }
          }
        },
        "stats": {
          "type": "object",
          "properties": {
            "total_nodes": {
              "type": "integer"
            },
            "total_edges": {
              "type": "integer"
            },
            "node_counts": {
              "type": "object"
            },
            "edge_counts": {
              "type": "object"
            },
            "citation_integrity_score": {
              "type": "number"
            },
            "citation_loop_count": {
              "type": "integer"
            },
            "round_trip_count": {
              "type": "integer"
            }
          }
        }
      },
      "additionalProperties": false
    },
    "citation_network": {
      "type": [
        "object",
        "null"
      ],
      "description": "Citation network reachable from task's claims. Only included when include_citations=true.",
      "properties": {
        "source_pages": {
          "type": "array",
          "description": "Pages that are evidence sources for this task's claims",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "title": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "url": {
                "type": "string"
              },
              "domain": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "citation_count": {
                "type": [
                  "integer",
                  "null"
                ]
              },
              "year": {
                "type": [
                  "integer",
                  "null"
                ]
              }
            }
          }
        },
        "citations": {
          "type": "array",
          "description": "Citation edges from source pages",
          "items": {
            "type": "object",
            "properties": {
              "edge_id": {
                "type": "string"
              },
              "citing_page_id": {
                "type": "string"
              },
              "cited_page_id": {
                "type": "string"
              },
              "cited_title": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "citation_source": {
                "type": [
                  "string",
                  "null"
                ]
              }
            }
          }
        },
        "hub_pages": {
          "type": "array",
          "description": "Highly-cited pages within this task's citation network (top 10)",
          "items": {
            "type": "object",
            "properties": {
              "page_id": {
                "type": "string"
              },
              "title": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "cited_by_count": {
                "type": "integer"
              }
            }
          }
        }
      },
      "additionalProperties": false
    },
    "format": {
      "type": "string",
      "enum": [
        "structured",
        "narrative"
      ]
    }
  },
  "required": [
    "ok",
    "task_id",
    "query",
    "claims",
    "fragments",
    "summary"
  ],
  "additionalProperties": false
}