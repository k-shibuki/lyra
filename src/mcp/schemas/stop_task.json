{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "lyra:mcp:stop_task",
  "title": "stop_task Response",
  "description": "Response schema for stop_task tool. Pauses a task session; task remains resumable.",
  "type": "object",
  "properties": {
    "ok": {
      "type": "boolean"
    },
    "task_id": {
      "type": "string"
    },
    "final_status": {
      "type": "string",
      "enum": ["paused", "cancelled"],
      "description": "Task status after stop. 'paused' = session ended, resumable. 'cancelled' = user explicit stop, still resumable."
    },
    "reason": {
      "type": "string",
      "enum": ["session_completed", "budget_exhausted", "user_cancelled"],
      "description": "Stop reason provided by caller. Default: session_completed."
    },
    "mode": {
      "type": "string",
      "enum": ["graceful", "immediate", "full"],
      "description": "Stop mode used (ADR-0010)"
    },
    "scope": {
      "type": "string",
      "enum": ["target_queue_only", "all_jobs"],
      "description": "Scope of job cancellation. all_jobs (default) = all job kinds cancelled. target_queue_only = only target jobs cancelled, verify_nli/citation_graph allowed to complete."
    },
    "cancelled_counts": {
      "type": "object",
      "description": "Counts of cancelled jobs by kind and state.",
      "properties": {
        "queued_cancelled": {"type": "integer"},
        "running_cancelled": {"type": "integer"},
        "tasks_cancelled": {"type": "integer"},
        "scheduler_jobs_cancelled": {"type": "integer"},
        "jobs_waited": {"type": "integer"},
        "by_kind": {
          "type": "object",
          "description": "Breakdown by job kind",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "queued": {"type": "integer"},
              "running": {"type": "integer"}
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    },
    "unaffected_kinds": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Job kinds NOT cancelled by this stop (when scope=target_queue_only)."
    },
    "summary": {
      "type": "object",
      "properties": {
        "total_searches": {"type": "integer"},
        "satisfied_searches": {"type": "integer"},
        "total_pages": {"type": "integer"},
        "total_fragments": {"type": "integer"},
        "total_claims": {"type": "integer"},
        "primary_source_ratio": {"type": "number"},
        "elapsed_seconds": {"type": "number"}
      },
      "additionalProperties": false
    },
    "is_resumable": {
      "type": "boolean",
      "description": "Always true. Task can be resumed by calling queue_targets with the same task_id."
    }
  },
  "required": ["ok", "task_id", "final_status"],
  "additionalProperties": false
}
