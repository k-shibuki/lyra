{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "lyra:mcp:calibration_metrics",
  "title": "calibration_metrics Response",
  "description": "Response schema for calibration_metrics tool (2 actions). Phase 6: evaluate and get_diagram_data were removed; use scripts for batch evaluation/visualization.",
  "oneOf": [
    {
      "title": "get_stats Response",
      "type": "object",
      "properties": {
        "ok": { "type": "boolean" },
        "action": { "type": "string", "const": "get_stats" },
        "current_params": {
          "type": "object",
          "description": "Current calibration parameters per source",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "version": { "type": "integer" },
              "method": { "type": "string" },
              "brier_after": { "type": ["number", "null"] },
              "samples_used": { "type": "integer" }
            }
          }
        },
        "history": {
          "type": "object",
          "description": "History statistics"
        },
        "recalibration_threshold": { "type": "integer" },
        "degradation_threshold": { "type": "number" }
      },
      "required": ["ok", "action", "current_params", "history"],
      "additionalProperties": false
    },
    {
      "title": "get_evaluations Response",
      "type": "object",
      "properties": {
        "ok": { "type": "boolean" },
        "action": { "type": "string", "const": "get_evaluations" },
        "evaluations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "evaluation_id": { "type": "string" },
              "source": { "type": "string" },
              "brier_score": { "type": "number" },
              "brier_score_calibrated": { "type": ["number", "null"] },
              "improvement_ratio": { "type": "number" },
              "expected_calibration_error": { "type": "number" },
              "samples_evaluated": { "type": "integer" },
              "calibration_version": { "type": ["integer", "null"] },
              "evaluated_at": { "type": "string" }
            }
          }
        },
        "total_count": { "type": "integer" },
        "filter_source": { "type": ["string", "null"] },
        "filter_since": { "type": ["string", "null"] },
        "returned_count": { "type": "integer" }
      },
      "required": ["ok", "action", "evaluations"],
      "additionalProperties": false
    }
  ]
}
